<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 9 Docker Containers for R | The Knowledge</title>
  <meta name="description" content="What every GDSLer should know to work from anywhere" />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 9 Docker Containers for R | The Knowledge" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="What every GDSLer should know to work from anywhere" />
  <meta name="github-repo" content="gdsl-ul/the_knowledge" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 Docker Containers for R | The Knowledge" />
  
  <meta name="twitter:description" content="What every GDSLer should know to work from anywhere" />
  

<meta name="author" content="Geographic Data Science Lab" />


<meta name="date" content="2020-06-03" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="jupyterlab.html"/>
<link rel="next" href="best-practices.html"/>
<script src="libs/header-attrs-2.1/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />












<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> The Knowledge</a></li>
<li class="chapter" data-level="2" data-path="remote-working.html"><a href="remote-working.html"><i class="fa fa-check"></i><b>2</b> Remote Working</a>
<ul>
<li class="chapter" data-level="2.1" data-path="remote-working.html"><a href="remote-working.html#what-is-remote-working"><i class="fa fa-check"></i><b>2.1</b> What is Remote Working?</a></li>
<li class="chapter" data-level="2.2" data-path="remote-working.html"><a href="remote-working.html#advantages-and-disadvantages-of-remote-work"><i class="fa fa-check"></i><b>2.2</b> Advantages and Disadvantages of Remote Work</a></li>
<li class="chapter" data-level="2.3" data-path="remote-working.html"><a href="remote-working.html#tips"><i class="fa fa-check"></i><b>2.3</b> Tips</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="vpn.html"><a href="vpn.html"><i class="fa fa-check"></i><b>3</b> VPN</a>
<ul>
<li class="chapter" data-level="3.1" data-path="vpn.html"><a href="vpn.html#what-is-a-vpn"><i class="fa fa-check"></i><b>3.1</b> <em>What is a VPN?</em></a></li>
<li class="chapter" data-level="3.2" data-path="vpn.html"><a href="vpn.html#how-can-i-setup-the-vpn-for-liverpool"><i class="fa fa-check"></i><b>3.2</b> <em>How can I setup the VPN for Liverpool?</em></a></li>
<li class="chapter" data-level="3.3" data-path="vpn.html"><a href="vpn.html#windows-and-mac"><i class="fa fa-check"></i><b>3.3</b> Windows and Mac</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="vpn.html"><a href="vpn.html#to-connect-and-disconnect-the-client"><i class="fa fa-check"></i><b>3.3.1</b> To connect and disconnect the client</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="vpn.html"><a href="vpn.html#ubuntu"><i class="fa fa-check"></i><b>3.4</b> Ubuntu</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="vpn.html"><a href="vpn.html#to-connect-the-client-and-disconnect-the-client"><i class="fa fa-check"></i><b>3.4.1</b> To connect the client and disconnect the client:</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ssh.html"><a href="ssh.html"><i class="fa fa-check"></i><b>4</b> SSH</a>
<ul>
<li class="chapter" data-level="4.1" data-path="ssh.html"><a href="ssh.html#what-is-ssh"><i class="fa fa-check"></i><b>4.1</b> What is SSH?</a></li>
<li class="chapter" data-level="4.2" data-path="ssh.html"><a href="ssh.html#connecting-to-a-remote-host"><i class="fa fa-check"></i><b>4.2</b> Connecting to a remote host</a></li>
<li class="chapter" data-level="4.3" data-path="ssh.html"><a href="ssh.html#unix-commands"><i class="fa fa-check"></i><b>4.3</b> Unix Commands</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="ssh.html"><a href="ssh.html#list-files"><i class="fa fa-check"></i><b>4.3.1</b> List Files:</a></li>
<li class="chapter" data-level="4.3.2" data-path="ssh.html"><a href="ssh.html#make-directory"><i class="fa fa-check"></i><b>4.3.2</b> Make Directory:</a></li>
<li class="chapter" data-level="4.3.3" data-path="ssh.html"><a href="ssh.html#move"><i class="fa fa-check"></i><b>4.3.3</b> Move:</a></li>
<li class="chapter" data-level="4.3.4" data-path="ssh.html"><a href="ssh.html#remove"><i class="fa fa-check"></i><b>4.3.4</b> Remove:</a></li>
<li class="chapter" data-level="4.3.5" data-path="ssh.html"><a href="ssh.html#change-your-working-directory"><i class="fa fa-check"></i><b>4.3.5</b> Change your Working Directory:</a></li>
<li class="chapter" data-level="4.3.6" data-path="ssh.html"><a href="ssh.html#copy"><i class="fa fa-check"></i><b>4.3.6</b> Copy:</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="ssh.html"><a href="ssh.html#command-line-editors"><i class="fa fa-check"></i><b>4.4</b> Command Line Editors</a></li>
<li class="chapter" data-level="4.5" data-path="ssh.html"><a href="ssh.html#practical"><i class="fa fa-check"></i><b>4.5</b> Practical</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="files.html"><a href="files.html"><i class="fa fa-check"></i><b>5</b> Files</a>
<ul>
<li class="chapter" data-level="5.1" data-path="files.html"><a href="files.html#backupsync"><i class="fa fa-check"></i><b>5.1</b> Backup/sync</a></li>
<li class="chapter" data-level="5.2" data-path="files.html"><a href="files.html#encryption"><i class="fa fa-check"></i><b>5.2</b> Encryption</a></li>
<li class="chapter" data-level="5.3" data-path="files.html"><a href="files.html#file-transfer"><i class="fa fa-check"></i><b>5.3</b> File Transfer</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="files.html"><a href="files.html#file-transfer-protocol-ftp"><i class="fa fa-check"></i><b>5.3.1</b> File Transfer Protocol (FTP)</a></li>
<li class="chapter" data-level="5.3.2" data-path="files.html"><a href="files.html#secure-copy-protocol-scp"><i class="fa fa-check"></i><b>5.3.2</b> Secure Copy Protocol (scp)</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="files.html"><a href="files.html#file-download"><i class="fa fa-check"></i><b>5.4</b> File Download</a></li>
<li class="chapter" data-level="5.5" data-path="files.html"><a href="files.html#practical-1"><i class="fa fa-check"></i><b>5.5</b> Practical</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="files.html"><a href="files.html#file-transfer-1"><i class="fa fa-check"></i><b>5.5.1</b> File Transfer</a></li>
<li class="chapter" data-level="5.5.2" data-path="files.html"><a href="files.html#file-download-1"><i class="fa fa-check"></i><b>5.5.2</b> File Download</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="data-science-stack.html"><a href="data-science-stack.html"><i class="fa fa-check"></i><b>6</b> Data Science Stack</a></li>
<li class="chapter" data-level="7" data-path="docker.html"><a href="docker.html"><i class="fa fa-check"></i><b>7</b> Docker</a>
<ul>
<li class="chapter" data-level="7.1" data-path="docker.html"><a href="docker.html#installation"><i class="fa fa-check"></i><b>7.1</b> Installation</a></li>
<li class="chapter" data-level="7.2" data-path="docker.html"><a href="docker.html#image-and-container"><i class="fa fa-check"></i><b>7.2</b> Image and Container</a></li>
<li class="chapter" data-level="7.3" data-path="docker.html"><a href="docker.html#useful-docker-commands"><i class="fa fa-check"></i><b>7.3</b> Useful Docker Commands</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="jupyterlab.html"><a href="jupyterlab.html"><i class="fa fa-check"></i><b>8</b> JupyterLab</a>
<ul>
<li class="chapter" data-level="8.1" data-path="jupyterlab.html"><a href="jupyterlab.html#run-jupyter-lab-locally"><i class="fa fa-check"></i><b>8.1</b> Run Jupyter Lab Locally</a></li>
<li class="chapter" data-level="8.2" data-path="jupyterlab.html"><a href="jupyterlab.html#run-jupyter-lab-remotely"><i class="fa fa-check"></i><b>8.2</b> Run Jupyter Lab Remotely</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="jupyterlab.html"><a href="jupyterlab.html#self-signed-certificate-warnings"><i class="fa fa-check"></i><b>8.2.1</b> Self-signed Certificate Warnings</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="jupyterlab.html"><a href="jupyterlab.html#using-sudo-within-a-container"><i class="fa fa-check"></i><b>8.3</b> Using sudo within a container</a></li>
<li class="chapter" data-level="8.4" data-path="jupyterlab.html"><a href="jupyterlab.html#useful-python-docker-images"><i class="fa fa-check"></i><b>8.4</b> Useful Python Docker Images</a></li>
<li class="chapter" data-level="8.5" data-path="jupyterlab.html"><a href="jupyterlab.html#practical-2"><i class="fa fa-check"></i><b>8.5</b> Practical</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="docker-containers-for-r.html"><a href="docker-containers-for-r.html"><i class="fa fa-check"></i><b>9</b> Docker Containers for R</a>
<ul>
<li class="chapter" data-level="9.1" data-path="docker-containers-for-r.html"><a href="docker-containers-for-r.html#run-docker-locally"><i class="fa fa-check"></i><b>9.1</b> Run Docker Locally</a></li>
<li class="chapter" data-level="9.2" data-path="docker-containers-for-r.html"><a href="docker-containers-for-r.html#run-docker-remotely"><i class="fa fa-check"></i><b>9.2</b> Run Docker Remotely</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="best-practices.html"><a href="best-practices.html"><i class="fa fa-check"></i><b>10</b> Best Practices</a>
<ul>
<li class="chapter" data-level="10.1" data-path="best-practices.html"><a href="best-practices.html#booking-a-server"><i class="fa fa-check"></i><b>10.1</b> Booking a server</a></li>
<li class="chapter" data-level="10.2" data-path="best-practices.html"><a href="best-practices.html#docker-considerations"><i class="fa fa-check"></i><b>10.2</b> Docker Considerations</a></li>
<li class="chapter" data-level="10.3" data-path="best-practices.html"><a href="best-practices.html#system-monitoring"><i class="fa fa-check"></i><b>10.3</b> System Monitoring</a></li>
<li class="chapter" data-level="10.4" data-path="best-practices.html"><a href="best-practices.html#gpu-considerations"><i class="fa fa-check"></i><b>10.4</b> GPU Considerations</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="best-practices.html"><a href="best-practices.html#monitoring"><i class="fa fa-check"></i><b>10.4.1</b> Monitoring</a></li>
<li class="chapter" data-level="10.4.2" data-path="best-practices.html"><a href="best-practices.html#memory-growth"><i class="fa fa-check"></i><b>10.4.2</b> Memory Growth</a></li>
<li class="chapter" data-level="10.4.3" data-path="best-practices.html"><a href="best-practices.html#temperature-monitoring"><i class="fa fa-check"></i><b>10.4.3</b> Temperature Monitoring</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The Knowledge</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="docker-containers-for-r" class="section level1" number="9">
<h1><span class="header-section-number">Chapter 9</span> Docker Containers for R</h1>
<p>A widely-used suite of docker images for R has been developed by the Rocker project <span class="citation">(Boettiger and Eddelbuettel <a href="#ref-RJ-2017-065" role="doc-biblioref">2017</a>)</span>. 29 repositories of rocker’s images are listed on the <a href="https://hub.docker.com/u/rocker/">docker hub</a> providing R environments customized to perform a variety of tasks. Most of them include R studio server, allowing to work remotely from the R studio server web interface accessible through any browser.</p>
<p>Rocker images are versioned, meaning that if you want to employ a specific version of R rather than the latest you can specify an R version tag in the image name, i.e. <em>rocker/verse:3.4.0</em>, if no tag is requested you will automatically pull the latest version <span class="citation">(Boettiger and Eddelbuettel <a href="#ref-RJ-2017-065" role="doc-biblioref">2017</a>)</span>.</p>
<div id="run-docker-locally" class="section level2" number="9.1">
<h2><span class="header-section-number">9.1</span> Run Docker Locally</h2>
<p>To run one of the rocker images locally on your laptop you need to install docker as described in <a href="06_docker.md"><code>docker.md</code></a> and pull the image of your choise from the docker hub.</p>
<p>An useful image for running geospatial analysis, including the tidyverse + various geospatial packages, is <a href="https://hub.docker.com/r/rocker/geospatial"><em>rocker/geospatial</em></a>:</p>
<p>You can pull the repository running the following command:</p>
<pre class="shell"><code>docker pull rocker/geospatial</code></pre>
<p>Once the image is on your local machine, you can run it with the following command:</p>
<pre class="shell"><code>docker run -e USER=&lt;your-user&gt; -e PASSWORD=&lt;your-password&gt; -e USERID=$UID -e GROUPID=$GID -d --rm -p 8787:8787 -v ${PWD}:/home/your-user rocker/geospatial</code></pre>
<p>All the docker run options used here have been described in <a href="06_docker.md"><code>docker.md</code></a>. Here, it is assumed that the port 8787 is not occupied on your local machine. If you do not have an instance of R studio server running, that port should be free.
The environment variables necessary to run an image with R studio server are the following:
* USER -&gt; you can add your user name
* PASSWORD -&gt; a secret password of your choice, along with the USER these env variables will be used to access the R studio server web interface.
* USERID and GROUPID -&gt; these ids are needed to have the user of the host machine be the same of the docker container. When these do not match it will change the ownership of the volume you are mounting on the container, generating issues particularly when you create or save new files.</p>
<p>Once you have run the command you can access Rstudio server running on your local host through a browser at: <a href="http://localhost:8787"><code>http://localhost:8787</code></a> and adding your credentials.</p>
</div>
<div id="run-docker-remotely" class="section level2" number="9.2">
<h2><span class="header-section-number">9.2</span> Run Docker Remotely</h2>
<p>Docker is installed on all our shared resources. Most machines already have images that can be used for gds. <em>Rocker/geospatial</em> has been extended to have all libraries that GDSL members generally use. This extended image has been named <em>rstudio_gdsl</em>.</p>
<p>Once you accessed the server you can list the existing images with the following command:</p>
<pre class="shell"><code>docker images ls</code></pre>
<p>You can pick the image that you need for your analysis, or pull a new image with the following command (the pull command can generally be copied from the docker hub image page, it is always good practice to check it as in some cases it needs further options):</p>
<pre class="shell"><code>docker pull *image tag*</code></pre>
<p>Once you decided which image you want to use, you can start building the run command with the appropriate options:</p>
<ul>
<li>-d and -rm are advised, the first will automatically detach you from the container while the second will remove the container when you stop it. Do not forget to remove the container manually whether you have not added the -rm option.</li>
<li>-p is needed to map the host’s port with the container’s port. To do this, you first need to verify which port is free to use. Ports that are permanently occupied on the servers are detailed on the servers_description file. In addition, you need to run <em>docker ps</em> to list the containers are running (if any) and verify which ports are using.</li>
<li>-e with the same environment variables that have been listed above.</li>
</ul>
<p>The final run command employing the extended image will look as follows:</p>
<pre class="shell"><code>docker run -e USER=&lt;your-user&gt; -e PASSWORD=&lt;your-password&gt; -e USERID=$UID -e GROUPID=$GID -d --rm -p &lt;free-port&gt;:8787 -v ${PWD}:/home/your-user rstudio_gdsl</code></pre>
<p>With the run command you generate a container where the image is running.
You can check your process with the <em>docker ps</em> command. As already mentioned above almost all rocker images include R studio server, therefore you can access the server-based application through its web interface. To do that, open your browser and go to the following address:</p>
<pre class="shell"><code>&lt;host-ip&gt;:&lt;port&gt;</code></pre>
<p>You can find the host IP address in the document describing the servers.</p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-RJ-2017-065">
<p>Boettiger, Carl, and Dirk Eddelbuettel. 2017. “An Introduction to Rocker: Docker Containers for R.” <em>The R Journal</em> 9 (2): 527–36. <a href="https://doi.org/10.32614/RJ-2017-065">https://doi.org/10.32614/RJ-2017-065</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="jupyterlab.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="best-practices.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/08_RStudio.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["gdsl_knowledge.pdf", "gdsl_knowledge.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
